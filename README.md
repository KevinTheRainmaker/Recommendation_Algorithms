# Recommendation_Algorithms
</br>


> ***"절대 거절 못할 제안을 하지"***</br>             
> <영화 '대부'에서></br>

</br>

---

## 추천 시스템의 개요

21세기는 '추천 시스템 전성시대'라고 봐도 무방하다.

아마존, 쿠팡 등 전자상거래 업체부터, 유튜브, 애플 뮤직 등 콘텐츠 포털까지, 대부분의 온라인 스토어는 사용자의 취향을 이해하고 최적의 상품과 콘텐츠를 추천하는 추천 시스템을 적극적으로 활용하고 있다.

범람하는 데이터의 홍수 속에, 사람들은 점점 더 선택에 어려움을 느끼고, 이는 사용자 경험에 악영향을 끼친다. 한정된 시간이라는 제약 조건 속에 너무 많은 선택지가 부여되는 것은 사용자로 하여금 압박감을 느끼게 하는데, 이러한 문제를 해결해주는 것이 바로 추천 시스템인 것이다.

추천 시스템을 채택하는 주체는 추천을 위한 대량의 데이터를 가진다. 예를 들어 온라인 스토어는 많은 양의 고객 데이터 및 상품 데이터를 가지고 있다.

- 사용자가 어떤 상품을 구매했는가?
- 사용자가 어떤 상품을 둘러보거나 장바구니에 넣었는가?
- 사용자가 평가한 평점은?
- 사용자가 스스로 작성한 자신의 취향은?
- 사용자가 무엇을 클릭했는가?

이러한 데이터들을 기반으로 추천 시스템은 '당신만을 위한 최신 상품', '이 상품은 어떠신가요?' 등의 캐치 프라이즈를 내걸고 추천을 진행한다.

</br>

---

## 추천 시스템의 유형

추천 시스템은 크게 콘텐츠 기반 필터링(Content-based filtering) 방식과 협업 필터링(Collaborative filtering) 방식으로 나뉜다. 그리고 협업 필터링 방식은 다시 최근접 이웃(Nearest Neighbor) 협업 필터링과 잠재 요인(Latent Factor) 협업 필터링으로 나뉜다.

초창기에는 콘텐츠 기반 필터링이나 최근접 이웃 기반 협업 필터링이 주로 사용됐지만, Netflix Prize에서 행렬 분해(Matrix Factorization) 기법을 활용한 잠재 요인 협업 필터링 방식이 우승하면서, 현재 대부분의 온라인 스토어에서는 잠재 요인 협업 필터링 기반의 추천 시스템을 적용 중이다.

물론 서비스하는 아이템의 특성에 따라 콘텐츠 기반 필터링이나 최근접 이웃 기반 협업 필터링 방식을 유지하는 곳도 많은데, 대표적인 곳이 바로 아마존이다. 아마존은 상품의 특성을 고려하는 아이템 기반 최근접 이웃 협업 필터링 방식을 사용한다. 

최근에는 개인화 특성을 좀 더 강화하기 위해 하이브리드 형식으로 콘텐츠 기반과 협업 기반을 적절히 결합해 사용하는 경우도 늘고 있다.

</br>

---
</br>

> ***"왜 그렇게 힘들게 돌을 두드리시나요?"*** </br>
> ***"꼬마야, 이 바위 안에는 천사가 들어있단다. 나는 지금 잠자는 천사를 깨워 자유롭게 해주는 중이야."***</br></br>
> <"다비드상"을 조각 중인 미켈란젤로와 한 소년의 대화>

</br>

---

## 콘텐츠 기반 필터링

콘텐츠 기반 필터링 방식은, 사용자가 특정한 아이템은 매우 선호하는 경우, 그 아이템과 비슷한 콘텐츠를 가진 다른 아이템을 추천하는 방식이다. 예를 들어 한 사용자가 특정 영화에 높은 평점을 줬다면, 그 영화의 장르, 출연진, 감독, 키워드 등 공통점을 갖는 유사한 다른 영화를 추천해주는 방식이다.

이는 보통 태그 형식으로 레이블된 데이터에 대하여 적용된다.

<!--
[[자세히]](https://mulberry-capacity-322.notion.site/Appendix_1-eb26627c29334f8c9a15c40220191acd)
-->
</br>

---

## 최근접 이웃 협업 필터링

신작 영화가 나왔을 때를 생각해보자. 영화를 보게된다면 만원이 넘는 영화 관람료는 물론이고, 영화관까지 이동하는 시간, 관람 시간 등 많은 소모가 발생한다. 그런데 이렇게 관람한 영화가 실망스럽다면 기분이 좋지 않을 것이다.

그래서 우리는 주변 친구들 중 나와 비슷한 취향의 친구들에게 물어보곤 한다.

*"이번에 나온 그 영화 봤어? 어때?"*

이렇듯, '친구에게 물어보는 것'과 유사한 추천 방식이 바로 최근접 이웃 협업 필터링이다. 사용자가 아이템에 매긴 정보나 상품 구매 이력 등의 사용자 행동 양식(User Behavior)만을 기반으로 추천을 수행하는 것으로, User-Item Matrix와 같은 축적된 사용자 행동 데이터를 기반으로 사용자가 아직 평가하지 않은 아이템을 예측 평가(Predicted Rating)하는 것이다.

<!--
[[자세히]](https://mulberry-capacity-322.notion.site/Appendix_2-9e83b0eeeea34ae8b2b1ee5eee4c11a9)
-->

</br>

---

## 잠재 요인 협업 필터링

잠재 요인 협업 필터링은 User-Item Matrix 속에 숨어 있는 잠재 요인을 추출해 추천 예측을 할 수 있게 하는 기법이다. 대규모 다차원 행렬을 SVD와 같은 차원감소 기법으로 분해하는 과정에서 잠재 요인을 추출하는데, 이러한 기법을 행렬 분해(Matrix Factorization)라고 한다.

행렬 분해 기반의 잠재 요인 협업 필터링은 Netflix Prize에서 우승한 모델이 사용했다는 사실이 알려지며 유명해진 알고리즘으로, 이후 많은 추천 시스템이 이러한 행렬 분해에 기반한 잠재 요인 협업 필터링을 적용하게 되었다.

협업 필터링의 주요 목표는 User-Item 평점 매트릭스와 같은 Sparse History Data(Behavior Data)를 기반으로 평가가 이루어지지 않은 아이템에 대해 예측 평가(Predicted Rating)하는 것이다.

협업 필터링 기반의 추천 시스템은 최근접 이웃 방식과 잠재요인 방식으로 나뉘며, 두 방식 모두 User-Item 평점 행렬 데이터에만 의지해 추천을 수행한다. 이 행렬에서 행은 사용자(User), 열은 아이템(Item)으로 구성되며 행과 열이 교파하는 지점에 해당 아이템에 대한 사용자의 평점이 표시된다.

<!--
[[자세히]](https://mulberry-capacity-322.notion.site/Appendix_3-93ef507c9aa6484f8c62dd7f6a575cdd)
-->

</br>

---